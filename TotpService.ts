import { authenticator } from 'otplib'import crypto from 'crypto'authenticator.options = {  step: 30,   window: [2, 2] }export class TotpService {  static generateSecret(): string {    return authenticator.generateSecret()  }  static generateToken(secret: string): string {    return authenticator.generate(secret)  }  static verifyToken(token: string, secret: string): boolean {    if (!token || !secret) return false    try {      return authenticator.verify({ token, secret })    } catch (error) {      console.error('[TotpService] verification error:', error)      return false    }  }  static generateOtpAuthUrl(secret: string, email: string, issuer = 'Pagandu Fintech'): string {    return authenticator.keyuri(email, issuer, secret)  }  static generateRecoveryCodes(count = 10): string[] {    const codes: string[] = []    for (let i = 0; i < count; i++) {      const code = crypto.randomBytes(4).toString('hex').toUpperCase()      codes.push(code)    }    return codes  }  static hashRecoveryCode(code: string): string {    return crypto.createHash('sha256').update(code.toUpperCase()).digest('hex')  }  static verifyRecoveryCode(code: string, hash: string): boolean {    const codeHash = this.hashRecoveryCode(code)    try {      return crypto.timingSafeEqual(        Buffer.from(codeHash, 'hex'),        Buffer.from(hash, 'hex')      )    } catch (e) {      return false    }  }}